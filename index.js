(()=>{"use strict";var e={250:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,a){function s(e){try{c(o.next(e))}catch(e){a(e)}}function r(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.identify=t.subscribe=t.publish=void 0,t.publish=(e,t)=>{window.todesktop.ipc.publish(e,t)},t.subscribe=(e,t)=>window.todesktop.ipc.subscribe(e,t),t.identify=()=>n(void 0,void 0,void 0,(function*(){return window.todesktop.ipc.identify()}))}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}(()=>{const e=window.todesktop,t=t=>(n,o)=>{const i="*"===n?Object.keys(t):[n];for(const n of i){const i=t[n];e.on(i,o)}},o=t=>(n,o)=>{const i="*"===n?Object.keys(t):[n];for(const n of i){const i=t[n];e.on(i,o)}},i={openProtocolURL:"open-protocol-url"};t(i),o(i);const a={show:"show",hide:"hide"};t(a),o(a);const s={enterFullscreen:"window.enter-full-screen",exitFullscreen:"window.leave-full-screen"};t(s),o(s);const r={start:"pushNotifications.start",error:"pushNotifications.error",tokenUpdate:"pushNotifications.tokenUpdate",receive:"pushNotifications.receive"};t(r),o(r);const c=("client-core","1.0.0-dev",function(e){const t={metadata:{package:{name:"client-core",version:"1.0.0-dev"},invoke:{version:"1.0.0"}},payload:{command:e}};return window.todesktop.invoke(t)});const w={navigate:"did-navigate"};async function d(e){return c({namespace:"BrowserWindow",method:":new",args:[e]})}async function u(e){return c({instanceRef:e,namespace:"BrowserWindow",method:"destroy",args:[]})}t(w),o(w);var h=n(250);const p=[];let l,f,y=null;const m="https://todesktop.github.io/todesktop-mvc-ipc",v=async(e,t,n)=>{const{x:o,y:i,w:a,h:s,url:r,partition:w}=n,d=await async function(e){return c({namespace:"BrowserView",method:":new",args:[e]})}({webPreferences:{partition:w}});return await async function(e,t,{url:n,action:o}){"addBrowserView"===o?await async function(e,t){return c({instanceRef:e,namespace:"BrowserWindow",method:"addBrowserView",args:[t]})}(e,t):await async function(e,t){return c({instanceRef:e,namespace:"BrowserWindow",method:"setBrowserView",args:[t]})}(e,t);const i=await async function(e){return c({instanceRef:e,namespace:"BrowserView",property:"webContents"})}(t);await async function(e,t){return c({instanceRef:e,namespace:"WebContents",method:"loadURL",args:[t]})}(i,n)}(t,d,{url:r,action:e}),await b(t,d,{x:o,y:i,w:a,h:s}),d},b=async(e,t,{x:n,y:o,w:i,h:a})=>{const[s,r]=await async function(e){return c({instanceRef:e,namespace:"BrowserWindow",method:"getSize",args:[]})}(e);await async function(e,t){return c({instanceRef:e,namespace:"BrowserView",method:"setBounds",args:[t]})}(t,{x:Math.round(s*n),y:Math.round(r*o),width:Math.round(s*i),height:Math.round(r*a)}),await async function(e,t){return c({instanceRef:e,namespace:"BrowserView",method:"setAutoResize",args:[{width:!0,height:!0,horizontal:!0,vertical:!0}]})}(t)};(0,h.subscribe)("workspace:created",(async({title:e})=>{p.find((t=>t.title===e))||(p.push({title:e}),(0,h.publish)("workspace:synced",{title:e}))})),(0,h.subscribe)("workspace:selected",(async({title:e})=>{p.some((t=>t.title===e))&&await g(e)}));const g=async e=>{await v("setBrowserView",f,{x:0,y:0,w:1,h:1,url:`${m}/spotlight.html`,partition:`memory:${e}`}),await async function(e,t){return c({instanceRef:e,namespace:"BrowserWindow",method:"setTitle",args:[t]})}(f,e),y&&await async function(e,t){return c({instanceRef:e,namespace:"BrowserWindow",method:"removeBrowserView",args:[t]})}(l,y),y=await v("addBrowserView",l,{x:.3,y:0,w:.7,h:1,url:`${m}/main.html`,partition:`persist:${e}`})};(async()=>{l=await d({width:750,height:480,frame:!1,vibrancy:"under-window",transparent:!0,titleBarStyle:"hiddenInset",trafficLightPosition:{x:12,y:15}}),f=await d({width:400,height:160}),await v("addBrowserView",l,{x:0,y:0,w:.3,h:1,url:`${m}/aside.html`}),window.addEventListener("unload",(async()=>{await Promise.all([u(l),u(f)])}))})()})()})();